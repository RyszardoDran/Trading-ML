2025-12-30 18:27:51 - ml.src.pipeline_config_extended - INFO - Pipeline configuration validated successfully
2025-12-30 18:27:51 - __main__ - INFO - 
================================================================================
2025-12-30 18:27:51 - __main__ - INFO - SEQUENCE XGBoost TRAINING PIPELINE - XAU/USD 1-Minute Data
2025-12-30 18:27:51 - __main__ - INFO - ================================================================================
2025-12-30 18:27:51 - __main__ - INFO - Log file: C:\Users\Arek\Documents\Repos\Traiding\Trading-ML\ml\outputs\logs\sequence_xgb_train_years_2020_2021_2022_2023_2024_2025_20251230_182751.log
2025-12-30 18:27:51 - __main__ - INFO - Start time: 2025-12-30 18:27:51
2025-12-30 18:27:51 - __main__ - INFO - Data years: [2020, 2021, 2022, 2023, 2024, 2025]
2025-12-30 18:27:51 - __main__ - INFO - 
Pipeline Configuration:
2025-12-30 18:27:51 - __main__ - INFO -   Feature engineering version: v1
2025-12-30 18:27:51 - __main__ - INFO -   Window size: 60 candles
2025-12-30 18:27:51 - __main__ - INFO -   ATR SL multiplier: 1.0x (from risk_config.py)
2025-12-30 18:27:51 - __main__ - INFO -   ATR TP multiplier: 2.0x (from risk_config.py)
2025-12-30 18:27:51 - __main__ - INFO -   Min hold time: 3 M5 candles
2025-12-30 18:27:51 - __main__ - INFO -   Max horizon: 60 M5 candles
2025-12-30 18:27:51 - __main__ - INFO -   Trading session: london_ny
2025-12-30 18:27:51 - __main__ - INFO -   Threshold optimization: HYBRID (EV with precision AND recall floors)
2025-12-30 18:27:51 - __main__ - INFO -     - Min precision: 0.65
2025-12-30 18:27:51 - __main__ - INFO -     - Min recall: 0.35
2025-12-30 18:27:51 - __main__ - INFO -     - Win coefficient: 1.0
2025-12-30 18:27:51 - __main__ - INFO -     - Loss coefficient: -1.0
2025-12-30 18:27:51 - __main__ - INFO -   M5 alignment filter: disabled
2025-12-30 18:27:51 - __main__ - INFO -   Trend filter: enabled
2025-12-30 18:27:51 - __main__ - INFO -   Pullback filter: disabled
2025-12-30 18:27:51 - __main__ - INFO -   Random state: 42
2025-12-30 18:27:51 - __main__ - INFO - ================================================================================

2025-12-30 18:27:51 - ml.src.pipeline_stages - INFO - Loading data from C:\Users\Arek\Documents\Repos\Traiding\Trading-ML\ml\src\data
2025-12-30 18:27:51 - ml.src.data_loading.loaders - INFO - Year filter applied: loading only [2020, 2021, 2022, 2023, 2024, 2025]
2025-12-30 18:27:54 - ml.src.pipeline_stages - INFO - Loaded 1,844,538 rows from C:\Users\Arek\Documents\Repos\Traiding\Trading-ML\ml\src\data
2025-12-30 18:27:54 - ml.src.pipeline_stages - INFO - Date range: 2020-01-02 06:00:00 to 2025-11-28 19:43:00
2025-12-30 18:27:54 - ml.src.pipeline_stages - WARNING - feature_version parameter is deprecated and ignored (passed: v1)
2025-12-30 18:27:54 - ml.src.pipeline_stages - INFO - Aggregating M1 data to M5 timeframe...
2025-12-30 18:27:54 - ml.src.features.engineer_m5 - INFO - Aggregating 1844538 M1 candles to M5...
2025-12-30 18:27:55 - ml.src.features.engineer_m5 - INFO - Aggregated to 369330 M5 candles (5.0x compression)
2025-12-30 18:27:55 - ml.src.pipeline_stages - INFO - Aggregated 1,844,538 M1 candles â†’ 369,330 M5 candles (20.0% compression)
2025-12-30 18:27:55 - ml.src.pipeline_stages - INFO - Engineering technical features on M5 timeframe (with M15/M60 context)...
2025-12-30 18:27:55 - __main__ - ERROR - Training pipeline failed: cannot access local variable 'close' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\Arek\Documents\Repos\Traiding\Trading-ML\ml\src\pipelines\sequence_training_pipeline.py", line 455, in <module>
    metrics = run_pipeline(params)
  File "C:\Users\Arek\Documents\Repos\Traiding\Trading-ML\ml\src\pipelines\sequence_training_pipeline.py", line 199, in run_pipeline
    features, df_m5 = engineer_features_stage(
                      ~~~~~~~~~~~~~~~~~~~~~~~^
        df_m1,
        ^^^^^^
        window_size=params.window_size,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        feature_version=params.feature_version
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Arek\Documents\Repos\Traiding\Trading-ML\ml\src\pipeline_stages.py", line 345, in engineer_features_stage
    features = engineer_m5_candle_features(df_m5)
  File "C:\Users\Arek\Documents\Repos\Traiding\Trading-ML\ml\src\features\engineer_m5.py", line 160, in engineer_m5_candle_features
    rolling_high = close.rolling(window_n, min_periods=1).max()
                   ^^^^^
UnboundLocalError: cannot access local variable 'close' where it is not associated with a value
